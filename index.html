<script>
  window.Telegram.WebApp.ready();
  document.getElementById('connect').addEventListener('click', async () => {
    try {
      if (window.solana && window.solana.isPhantom) {
        const resp = await window.solana.connect();
        const pubkey = resp.publicKey.toString();
        // envoie la clé publique au bot
        Telegram.WebApp.sendData(JSON.stringify({ pubkey }));
        // message de confirmation
        document.body.innerHTML = '<h2>✅ Wallet connecté !</h2>';
        // ferme la WebApp après 1.5 s
        setTimeout(() => Telegram.WebApp.close(), 1500);
      } else {
        alert('Phantom Wallet non détecté. Installez-le pour continuer.');
      }
    } catch (err) {
      console.error('Erreur de connexion Phantom:', err);
      alert('Connexion échouée. Vérifiez Phantom Wallet.');
    }
  });
</script>
